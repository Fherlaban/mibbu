var o=void 0,mibbu=function(I,J,y){function p(){for(var c=m.length,d,e,f,h,i,b,a,z,A;c--;)for(d in e=m[c],h=e.c+e.d.w,i=e.c+e.height-e.d.o,b=e.b+e.d.t,e=e.b+e.width-e.d.v,m[c].r)if(f=B[d],a=f.c+f.d.w,z=f.c+f.height-f.d.o,A=f.b+f.d.t,f=f.b+f.width-f.d.v,!(h>z||i<a||b>f||e<A))m[c].r[d]()}function C(){D();for(var c=d.length;c--;)d[c].F();for(c=g.length;c--;)g[c]();if(r){c=new Date;~~(c.getTime()-t.getTime())>=1E3&&(E=u,u=0,t=c);c="FPS: "+E;if(i)l.fillText(c,4,15);else if(s)s.innerHTML=c;u++}v&&(F=G(C,h))}function K(){h=k.createElement("canvas");l=h.getContext("2d");l.s=l.drawImage;d.sort(function(c,d){return c.h-d.h})}function L(){D=i?function(){l.clearRect(0,0,w,x)}:function(){};r&&(t=new Date);G=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(c){setTimeout(c,1E3/60)}}();n=h.style;h.width=w;h.height=x;n.width=w+"px";n.height=x+"px";n.position="absolute";n.overflow="hidden";H.appendChild(h)}var i=!0,j=!1,k=document,d=[],H=y?k.getElementById(y):k.body,h,l,w=I||400,x=J||300,g=[],F,D,t=new Date,r=!1,s,m=[],B=[],G,n;Array.prototype.indexOf=Array.prototype.indexOf||function(c){for(var d=this.length;d--&&this[d]!==c;);return d};var u=0,E=0,v=!0;k.createElement("canvas").getContext||(i=!1);return{fps:function(){r=!0},init:function(){i?K():(h=k.createElement("div"),r&&(s=k.createElement("div"),h.appendChild(s)));L()},on:function(){v=!0;C();if(j)for(var c=d.length;c--;)if(d[c].a)d[c].a.style.webkitAnimationDuration=~~(1/(60/d[c].e)*100)/100*(d[c].g+1)+"s"},off:function(){clearTimeout(F);v=!1;if(j)for(var c=d.length;c--;)if(d[c].a)d[c].a.style.webkitAnimationDuration=0},canvas:function(){return h},ctx:function(){return l},canvasOff:function(){i=!1;typeof H.style.webkitAnimation!=="undefined"&&(j=!0)},cssAnimationOff:function(){j=!1},hitsOn:function(){g.indexOf(p)===-1&&g.push(p)},hitsOff:function(){g.indexOf(p)!==-1&&g.splice(g.indexOf(p),1)},spr:function(c,g,e,f,n){function q(){for(var b="@-webkit-keyframes 'sprite"+a.id+"' {\n",c=100/(a.g+1),s="% { -webkit-transform: translate3d(", d=0;d<a.g+1;d++)b+=~~(c*d*100)/100+s+a.i*a.width*-1+"px,"+d*a.height*-1+"px, 0); }\n",b+=~~((c*(d+1)-0.01)*100)/100+s+a.i*a.width*-1+"px,"+d*a.height*-1+"px, 0); }\n";return b+("100"+s+a.i*a.width+"px, 0px, 0); }\n}")}var b=i?function(){try{l.s(a.a,a.D*a.i,a.C*a.l,a.D,a.C,a.b,a.c,a.width,a.height)}catch(b){}}:j?function(){}:function(){a.a.style.top=a.height*a.l*-1+"px";a.a.style.left=a.width*a.i*-1+"px"},a={};a.id=d.length;a.a=new Image;a.a.src=c;a.e=1;a.width=g;a.D=g;a.height=e;a.C=e;a.g=f;a.G=n;a.H=!1;a.r={};a.l=0;a.i=0;a.e=1;a.n=0;a.b=0;a.c=0;a.h=1;a.q=null;a.p=0;a.A=0;a.d={w:0,t:0,o:0,v:0};if(!i){a.B=k.createElement("div");a.f=a.B.style;a.f.overflow="hidden";a.f.width=g+"px";a.f.height=e+"px";a.f.position="absolute";a.f.zIndex=a.h;a.a.style.position="absolute";if(j)a.m=k.createElement("style"),a.m.innerHTML=q(),k.getElementsByTagName("head")[0].appendChild(a.m),a.a.style.webkitAnimation="'sprite"+a.id+"' "+~~(1/(60/a.e)*100)/100*(a.g+1)+"s linear 0 infinite";a.B.appendChild(a.a);h.appendChild(a.B)}a.id=d.push(a)-1;B.push(a);a.F=function(){if(a.g>0){if(a.n==a.e&&a.e!==0){if(a.l==a.g){if(a.l=0,typeof a.q==="function"&&(a.p++,a.p===a.A))a.q(),a.p=0}else a.l++;a.n=0}a.e!==0&&a.n++;b()}};return{position:function(b,c,e){a.b=b||a.b;a.c=c||a.c;a.h=e||a.h;i?e&&d.sort(function(a,b){return b.h-a.h}):(a.f.left=b+"px",a.f.top=c+"px",a.f.zIndex=e||a.h);return{x:a.b,y:a.c,I:a.h}},hit:function(b,c){m.indexOf(a)===-1&&m.push(a);a.r[b.id()]=c;m.indexOf(a)===-1&&m.push(a)},zone:function(b,c,d,e){if(b!==o)a.d.t=e,a.d.w=b,a.d.v=c,a.d.o=d;return a.d},noHits:function(){a.r={}},callback:function(b,c){a.q=b;a.A=c},change:function(b,c,d,e,f){a.a.src=b;a.width=c;a.height=d;a.D=c;a.C=d;a.g=e;a.i=f;a.n=0;a.l=0;a.q=null;a.p=0;a.A=0;if(!i&&(a.a.style.width=c*(a.i+1)+"px",a.a.style.height=d*(a.g+1)+"px",a.f.width=c+"px",a.f.height=d+"px",j))a.a.style.webkitAnimationName="",a.m.innerHTML=q(),a.a.style.webkitAnimationName="sprite"+a.id;a.d={w:0,t:0,o:0,v:0}},size:function(b,c){if(b!==o){if(!i)a.f.width=b+"px",a.f.height=c+"px",a.a.style.width=b*(a.G+1)+"px",a.a.style.height=c*(a.g+1)+"px";a.width=b;a.height=c;if(j)a.a.style.webkitAnimationName="",a.m.innerHTML=q(),a.a.style.webkitAnimationName="sprite"+a.id}return{width:a.width,height:a.height}},speed:function(b){if(b!==o&&(a.e=b,a.n=0,j))a.a.style.webkitAnimationDuration=~~(1/(60/b)*100)/100*(a.g+1)+"s";return a.e},animation:function(b){if(b!==o&&(a.i=b,j))a.a.style.webkitAnimationName="",a.m.innerHTML=q(),a.a.style.webkitAnimationName="sprite"+a.id;return a.i},frame:function(b){if(b!==o)a.l=b;return a.l},id:function(){return a.id}}},bg:function(c,g,e,f){function j(a){switch(a){case "N":b.j=0;b.k=-1;break;case "W":b.j=-1;b.k=0;break;case "S":b.j=0;b.k=1;break;case "E":b.j=1;b.k=0;break;default:b.j=0,b.k=0}}var k=i?function(){try{l.s(b.a,b.b,b.c),l.s(b.a,b.b+b.a.width*b.j,b.c+b.a.height*b.k),l.s(b.a,b.b-b.a.width*b.j,b.c-b.a.height*b.k)}catch(a){}if(b.j===-1){if(b.b<b.a.width*-1)b.b=0}else if(b.j===1){if(b.b>b.a.width)b.b=0}else if(b.k===-1){if(b.c<b.a.height*-1)b.c=0}else if(b.k===1&&b.c>b.a.height)b.c=0}:function(){h.style.backgroundPosition=b.b+"px "+b.c+"px"},b=this;i?(b.a=new Image,b.a.src=c):h.style.backgroundImage="url("+c+")";b.e=g||3;j(e);b.h=f.z||0;b.b=f.x||0;b.c=f.y||0;b.id=d.push(b);b.u=0;b.F=function(){b.b+=b.e*b.j*b.u;b.c+=b.e*b.k*b.u;k()};return{on:function(){b.u=1},off:function(){b.u=0},dir:function(a){b.b=b.c=0;j(a)},speed:function(a){if(a!==o)b.e=a;return b.e},position:function(a,c){b.b=a||b.b;b.c=c||b.c;return{x:b.b,y:b.c}}}},hook:function(c){g.push(c)},unhook:function(c){g.indexOf(c)!==-1&&g.splice(g.indexOf(c),1)}}};