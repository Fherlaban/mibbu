var n=void 0,mibbu=function(H,I,x){function o(){for(var b=i.length,r,d,e,c,h,a,g,y,z;b--;)for(r in d=i[b],c=d.c+d.d.t,h=d.c+d.height-d.d.n,a=d.b+d.d.q,d=d.b+d.width-d.d.s,i[b].o)if(e=A[r],g=e.c+e.d.t,y=e.c+e.height-e.d.n,z=e.b+e.d.q,e=e.b+e.width-e.d.s,!(c>y||h<g||a>e||d<z))i[b].o[r]()}function B(){C();for(var b=l.length;b--;)l[b].F();for(b=f.length;b--;)f[b]();if(p){b=new Date;~~(b.getTime()-s.getTime())>=1E3&&(D=t,t=0,s=b);b="FPS: "+D;if(h)j.fillText(b,4,15);else if(q)q.innerHTML=b;t++}u&&(E=F(B,c))}function J(){c=k.createElement("canvas");G();j=c.getContext("2d");j.p=j.drawImage;l.sort(function(b,c){return b.g-c.g})}function G(){C=h?function(){j.clearRect(0,0,v,w)}:function(){};p&&(s=new Date);F=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(b){setTimeout(b,1E3/60)}}();m=c.style;c.width=v;c.height=w;m.width=v+"px";m.height=w+"px";m.position="absolute";m.overflow="hidden";K.appendChild(c)}var h=!0,k=window.document,l=[],K=x?k.getElementById(x):k.body,c,j,v=H||400,w=I||300,f=[],E,C,s=new Date,p=!1,q,i=[],A=[],F,m;Array.prototype.indexOf=Array.prototype.indexOf||function(b){for(var c=this.length;c--&&this[c]!==b;);return c};var t=0,D=0,u=!0;k.createElement("canvas").getContext||(h=!1);return{fps:function(){p=!0},init:function(){h?J():(c=k.createElement("div"),G(),p&&(q=k.createElement("div"),c.appendChild(q)))},on:function(){u=!0;B()},off:function(){clearTimeout(E);u=!1},canvas:function(){return c},ctx:function(){return j},canvasOff:function(){h=!1},hitsOn:function(){f.indexOf(o)===-1&&f.push(o)},hitsOff:function(){f.indexOf(o)!==-1&&f.splice(f.indexOf(o),1)},spr:function(b,f,d,e,m){var o=h?function(){try{j.p(a.a,a.C*a.m,a.B*a.j,a.C,a.B,a.b,a.c,a.width,a.height)}catch(g){}}:function(){a.a.style.top=a.height*a.j*-1+"px";a.a.style.left=a.width*a.m*-1+"px"},a={};a.id=l.length;a.a=new Image;a.a.src=b;a.f=1;a.width=f;a.C=f;a.height=d;a.B=d;a.k=e;a.u=m;a.G=!1;a.o={};a.j=0;a.m=0;a.f=1;a.l=0;a.b=0;a.c=0;a.g=1;a.w=null;a.v=0;a.D=0;a.d={t:0,q:0,n:0,s:0};if(!h)a.A=k.createElement("div"),a.e=a.A.style,a.e.overflow="hidden",a.e.width=f+"px",a.e.height=d+"px",a.e.position="absolute",a.e.zIndex=a.g,a.a.style.position="absolute",a.A.appendChild(a.a),c.appendChild(a.A);a.id=l.push(a)-1;A.push(a);a.F=function(){if(a.k>0){if(a.l==a.f&&a.f!==0){if(a.j==a.k){if(a.j=0,typeof a.w==="function"&&(a.v++,a.v===a.D))a.w(),a.v=0}else a.j++;a.l=0}a.f!==0&&a.l++;o()}};return{position:function(g,b,c){a.b=g||a.b;a.c=b||a.c;a.g=c||a.g;h?c&&l.sort(function(a,g){return g.g-a.g}):(a.e.left=g+"px",a.e.top=b+"px",a.e.zIndex=c||a.g);return{x:a.b,y:a.c,H:a.g}},hit:function(g,b){i.indexOf(a)===-1&&i.push(a);a.o[g.id()]=b;i.indexOf(a)===-1&&i.push(a)},zone:function(g,b,c,d){if(g!==n)a.d.q=d,a.d.t=g,a.d.s=b,a.d.n=c;return a.d},noHits:function(){a.o={}},callback:function(g,b){a.w=g;a.D=b},change:function(b,c,d,e,f){a.a.src=b;a.width=c;a.height=d;a.C=c;a.B=d;a.k=e;a.u=f;a.l=0;a.j=0;if(!h)a.a.style.width=c*(a.u+1)+"px",a.a.style.height=d*(a.k+1)+"px",a.e.width=c+"px",a.e.height=d+"px";a.d={t:0,q:0,n:0,s:0}},size:function(b,c){if(b!==n){if(!h)a.e.width=b+"px",a.e.height=c+"px",a.a.style.width=b*(a.u+1)+"px",a.a.style.height=c*(a.k+1)+"px";a.width=b;a.height=c}return{width:a.width,height:a.height}},speed:function(b){if(b!==n)a.f=b,a.l=0;return a.f},animation:function(b){if(b!==n)a.m=b;return a.m},frame:function(b){if(b!==n)a.j=b;return a.j},id:function(){return a.id}}},bg:function(b,f,d,e){function i(b){switch(b){case "N":a.h=0;a.i=-1;break;case "W":a.h=-1;a.i=0;break;case "S":a.h=0;a.i=1;break;case "E":a.h=1;a.i=0;break;default:a.h=0,a.i=0}}var k=h?function(){try{j.p(a.a,a.b,a.c),j.p(a.a,a.b+a.a.width*a.h,a.c+a.a.height*a.i),j.p(a.a,a.b-a.a.width*a.h,a.c-a.a.height*a.i)}catch(b){}if(a.h===-1){if(a.b<a.a.width*-1)a.b=0}else if(a.h===1){if(a.b>a.a.width)a.b=0}else if(a.i===-1){if(a.c<a.a.height*-1)a.c=0}else if(a.i===1&&a.c>a.a.height)a.c=0}:function(){c.style.backgroundPosition=a.b+"px "+a.c+"px"},a=this;h?(a.a=new Image,a.a.src=b):c.style.backgroundImage="url("+b+")";a.f=f||3;i(d);a.g=e.z||0;a.b=e.x||0;a.c=e.y||0;a.id=l.push(a);a.r=0;a.F=function(){a.b+=a.f*a.h*a.r;a.c+=a.f*a.i*a.r;k()};return{on:function(){a.r=1},off:function(){a.r=0},dir:function(b){a.b=a.c=0;i(b)},speed:function(b){if(b!==n)a.f=b;return a.f},position:function(b,c){a.b=b||a.b;a.c=c||a.c;return{x:a.b,y:a.c}}}},hook:function(b){f.push(b)},unhook:function(b){f.indexOf(b)!==-1&&f.splice(f.indexOf(b),1)}}};